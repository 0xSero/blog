/* ============================================
   MAIN STYLESHEET ENTRY
   Import order matters: tokens → base → components → utilities
   ============================================ */

/* Design System Tokens (must be first for CSS variable definitions) */
@import './design-system/tokens.css';

/* Tailwind layers */
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Japanese Minimalism utilities */
@import './design-system/japanese-minimalism.css';

/* Geist Font Import */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

/* ============================================
   BASE LAYER
   ============================================ */
@layer base {
  html {
    @apply scroll-smooth;
  }

  body {
    background-color: var(--color-surface-base);
    color: var(--color-text-primary);
    font-family: var(--font-family-sans);
    font-feature-settings: 'rlig' 1, 'calt' 1;
  }

  ::selection {
    background-color: hsl(35, 15%, 30%);
    color: var(--color-text-primary);
  }

  /* Focus ring styles - warm brown */
  *:focus-visible {
    @apply outline-none ring-2 ring-offset-2;
    --tw-ring-color: var(--color-interactive-default);
    --tw-ring-offset-color: var(--color-surface-base);
  }
}

/* ============================================
   MARKDOWN / PROSE UTILITIES
   ============================================ */
.task-list-item::before {
  @apply hidden;
}

.task-list-item {
  @apply list-none;
}

.footnotes {
  @apply mt-12 pt-8;
  border-top: 1px solid var(--color-border-default);
}

.csl-entry {
  @apply my-5;
}

/* Line clamp utility */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ============================================
   CUSTOM SCROLLBAR - Warm paper theme
   ============================================ */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background-color: var(--color-surface-base);
}

::-webkit-scrollbar-thumb {
  background-color: var(--color-border-strong);
  border-radius: 9999px;
}

::-webkit-scrollbar-thumb:hover {
  background-color: hsl(30, 5%, 35%);
}

/* ============================================
   FORM AUTOFILL - Dark theme compatible
   ============================================ */
input:-webkit-autofill,
input:-webkit-autofill:focus {
  transition: background-color 600000s 0s, color 600000s 0s;
}

input:-webkit-autofill {
  -webkit-text-fill-color: var(--color-text-primary);
  -webkit-box-shadow: 0 0 0px 1000px var(--color-surface-base) inset;
}

/* ============================================
   ESCHER UTILITIES (kept for portal page)
   ============================================ */
@layer utilities {
  .stroke-draw {
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    animation: draw-line 2s ease-out forwards;
  }

  .paper-texture {
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
  }

  .impossible-shadow {
    box-shadow: 4px 4px 0 0 var(--color-border-default), 8px 8px 0 0 var(--color-border-subtle);
  }

  /* Text gradient for warm theme */
  .text-gradient-warm {
    background: linear-gradient(
      135deg,
      var(--color-text-primary) 0%,
      var(--color-accent-subtle) 100%
    );
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
}

/* ============================================
   ESCHER PATTERN BACKGROUND (legacy)
   ============================================ */
.escher-pattern {
  background-image: linear-gradient(
      30deg,
      hsl(30, 5%, 15%) 12%,
      transparent 12.5%,
      transparent 87%,
      hsl(30, 5%, 15%) 87.5%,
      hsl(30, 5%, 15%)
    ),
    linear-gradient(
      150deg,
      hsl(30, 5%, 15%) 12%,
      transparent 12.5%,
      transparent 87%,
      hsl(30, 5%, 15%) 87.5%,
      hsl(30, 5%, 15%)
    ),
    linear-gradient(
      30deg,
      hsl(30, 5%, 15%) 12%,
      transparent 12.5%,
      transparent 87%,
      hsl(30, 5%, 15%) 87.5%,
      hsl(30, 5%, 15%)
    ),
    linear-gradient(
      150deg,
      hsl(30, 5%, 15%) 12%,
      transparent 12.5%,
      transparent 87%,
      hsl(30, 5%, 15%) 87.5%,
      hsl(30, 5%, 15%)
    ),
    linear-gradient(
      60deg,
      hsl(30, 5%, 18%) 25%,
      transparent 25.5%,
      transparent 75%,
      hsl(30, 5%, 18%) 75%,
      hsl(30, 5%, 18%)
    ),
    linear-gradient(
      60deg,
      hsl(30, 5%, 18%) 25%,
      transparent 25.5%,
      transparent 75%,
      hsl(30, 5%, 18%) 75%,
      hsl(30, 5%, 18%)
    );
  background-size: 80px 140px;
  background-position: 0 0, 0 0, 40px 70px, 40px 70px, 0 0, 40px 70px;
}

/* ============================================
   SCROLLING ANIMATION
   ============================================ */
@keyframes scroll {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(-50%);
  }
}

.animate-scroll {
  animation: scroll 30s linear infinite;
}

.animate-scroll:hover {
  animation-play-state: paused;
}

/* Penrose triangle inspired border */
.penrose-border {
  position: relative;
}

.penrose-border::before {
  content: '';
  position: absolute;
  inset: -2px;
  background: linear-gradient(
    45deg,
    var(--color-border-strong) 0%,
    var(--color-border-default) 25%,
    hsl(30, 5%, 40%) 50%,
    var(--color-border-default) 75%,
    var(--color-border-strong) 100%
  );
  z-index: -1;
  border-radius: inherit;
}
